# データベースとは何か - わかりやすい説明

## データベースとは？

**データベース = デジタルの倉庫・図書館**

例えば、あなたのコミュニティギャラリーで考えてみましょう：

### 現実世界の例
- **図書館**: 本を整理して保管、検索できるシステム
- **倉庫**: 商品を分類して保管、必要な時に取り出せる

### デジタル世界のデータベース
- **ユーザー情報**: 誰が登録しているか
- **作品データ**: どんな作品がアップロードされているか
- **コメント**: 誰がどの作品にコメントしたか
- **いいね**: 誰がどの作品を気に入ったか

## データベースを構築するとは？

**= 倉庫の設計図を作って、実際に倉庫を建てること**

### 1. 設計（スキーマ作成）
```sql
-- 「ユーザー」という棚を作る
CREATE TABLE profiles (
  id UUID PRIMARY KEY,        -- 身分証明書番号
  email TEXT,                 -- メールアドレス
  display_name TEXT,          -- 表示名
  created_at TIMESTAMP        -- 登録日
);

-- 「作品」という棚を作る  
CREATE TABLE works (
  id UUID PRIMARY KEY,        -- 作品番号
  user_id UUID,               -- 誰の作品か
  title TEXT,                 -- 作品タイトル
  image_urls TEXT[],          -- 画像のURL
  created_at TIMESTAMP        -- 投稿日
);
```

### 2. 実際の構築
- Supabaseというサービスに上記の「棚」を実際に作る
- 各棚にどんなデータを入れるかのルールを決める

## データベースを実装するとは？

**= 倉庫とアプリを繋げて、実際に荷物を出し入れできるようにすること**

### 現在のあなたのプロジェクトの状況

#### ✅ 完了済み：設計図は完成
```typescript
// supabase-schema.sql に書かれている設計図
CREATE TABLE profiles (...);  // ユーザー情報の棚
CREATE TABLE works (...);     // 作品情報の棚  
CREATE TABLE comments (...);  // コメントの棚
CREATE TABLE likes (...);     // いいねの棚
```

#### ✅ 完了済み：倉庫への道筋も完成
```typescript
// src/lib/supabase.ts に書かれている接続コード
export const supabase = createClient(supabaseUrl, supabaseKey)

// 作品を取得する関数も準備済み
export const getWorks = async () => {
  const { data, error } = await supabase
    .from('works')  // 「作品」の棚から
    .select('*')    // 全部取り出して
  return data
}
```

#### 🔄 現在の状況：サンプルデータで動作確認中
```typescript
// page.tsx で現在使っているダミーデータ
const sampleWorks = [
  { id: 1, title: "夕暮れの風景", author: "山田太郎" },
  { id: 2, title: "抽象アート", author: "佐藤花子" }
];
```

### 次にやることは？

#### 1. 本物の倉庫を用意する
- Supabaseで実際のデータベースを作る（現在はダミー設定）
- `.env.local`に本物のURLとキーを設定

#### 2. サンプルデータを本物のデータに切り替える
```typescript
// 変更前（現在）
const works = sampleWorks;

// 変更後（実装後）
const works = await getWorks(); // 本物のデータベースから取得
```

#### 3. 荷物の出し入れ機能を完成させる
- 作品投稿 → データベースに保存
- ユーザー登録 → データベースに保存  
- コメント投稿 → データベースに保存

### わかりやすい例え

現在のあなたのプロジェクトは：
- **設計図**: ✅ 完成（どんな棚を作るか決まっている）
- **道具**: ✅ 完成（データを出し入れする関数ができている）
- **倉庫**: 🔄 仮の倉庫（本物はこれから作る）
- **実際の運用**: 🔄 サンプル商品で練習中（本物の商品はこれから）

つまり、**準備は完璧にできているので、あとは本物の倉庫を用意して、実際に使い始めるだけ**という状況です！

## 用語集

### データベース関連
- **テーブル**: データを整理する「棚」
- **カラム**: テーブルの「項目」（名前、メールアドレスなど）
- **レコード**: テーブルの「1行」（1人のユーザー情報など）
- **主キー**: 各レコードを識別する「背番号」
- **外部キー**: 他のテーブルとの「関係」を示す番号

### Supabase関連
- **Supabase**: データベースを簡単に作れるサービス
- **RLS (Row Level Security)**: 「誰がどのデータを見れるか」のルール
- **Magic Link**: パスワード不要でメールでログインする仕組み

### 開発関連
- **スキーマ**: データベースの「設計図」
- **CRUD**: Create（作成）、Read（読み取り）、Update（更新）、Delete（削除）の基本操作
- **API**: アプリとデータベースをつなぐ「橋」

---

作成日：2025年1月13日  
対象プロジェクト：未完成ギャラリー コミュニティサイト